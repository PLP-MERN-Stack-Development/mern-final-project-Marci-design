# .github/workflows/backend-cd.yml

name: Backend CD

# This workflow runs only after the 'Backend CI' workflow completes successfully on the main branch
on:
  workflow_run:
    workflows: ["Backend CI"]
    types:
      - completed
    branches: [ "main" ]

jobs:
  deploy-backend:
    # Only run this job if the upstream workflow (CI) succeeded
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Render Deployment
        # This action makes a simple HTTP POST request to the webhook URL
        uses: fjogeleit/http-request-action@v1
        with:
          # The URL is retrieved from GitHub Secrets for security
          url: ${{ secrets.RENDER_DEPLOY_HOOK_URL }}
          method: 'POST'